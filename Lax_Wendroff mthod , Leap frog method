
/*
Problem Statement : write a C programme to find the numerical solution of the initial value problem 
U_x+U_t =0,-2<= x<= 5, t>0

with the initial condiotions ,
U(x,0) = 0 ( x<0)
         x/2 ( 0<= x<=2)
         2-x/2 (2<= x<=4)
         0(x>4)
         
         
Use 
a. Lax_Wendroff mthod
b. Leap frog method 

to compute the result upto 5 time steps by taking mesh size h=0.1 and CFL number 0.5 */




#include<stdio.h>
#include<math.h>
#include<stdlib.h>

#define N 10
#define M 5
#define h 0.7
#define lambda 0.5
#define k (lambda*h)

void initialize( double u[N+1])
{ double x;
for(int i=0;i<=N;i++)
{  x=-2.0+i*h;
   if(x<0||x>4)u[i]=0.0;
   else if(x<=2) u[i]=x/2.0;
   else u[i]=(2.0-x/2.0);}}
   
   
void lax_wendroff( double u[N+1], double u_new[N+1])
{ for(int i=1;i<N;i++)
{  u_new[i]=u[i]-0.5*lambda*(u[i+1]-u[i-1])+0.5*lambda*lambda*(u[i+1]-2*u[i]+u[i-1]);}
u_new[0]=u_new[1];
u_new[N]=u_new[N-1];}


void leap_frog( double u[N+1], double u_prev[N+1], double u_new[N+1])
{  for( int i=1;i<N;i++)
{  u_new[i]=u_prev[i]-lambda*(u[i+1]-u[i-1]);}
u_new[0]=u_new[1];
u_new[N]=u_new[N-1];}


void print_solution( double u[N+1],int step)
{ printf("\t x \t t \t u \n\n ");
for(int i=0;i<=N;i++)
{  printf(" \t %0.2f \t %0.2f \t %0.6f\n"
, -2.0+i*h,k*step,u[i]);
printf("\n");
}
printf("\n");}

int main()
{  double u[N+1],u_new[N+1],u_prev[N+1];
  initialize(u);
  printf(" Initial Condition :\n");
  print_solution(u,0);
  
  printf(" Lax-Wenroff Method:\n");
  for( int t=0;t<=M;t++)
  { lax_wendroff(u,u_new);
    for(int i=0;i<=N;i++)
    {  u[i]=u_new[i];}
    print_solution(u,t);}
    
    initialize(u);
    initialize(u_prev);
    lax_wendroff(u,u_prev);
    
    printf(" Leap Frog method :\n\n ");
    
    for(int t=1;t<=M;t++)
    {  leap_frog(u,u_prev,u_new);
       for(int i=0;i<=N;i++)
       {  u_prev[i]=u[i];
          u[i]=u_new[i];}
          print_solution(u,t);} 
          printf("\n ( All result are correct upto 6 decimal places )");
          return 0;}
                                       
                                       
                                       
                                       
                                       
  Initial Condition :
	 x 	 t 	 u 

  	 -2.00 	 0.00 	 0.000000

 	 -1.30 	 0.00 	 0.000000

 	 -0.60 	 0.00 	 0.000000

 	 0.10 	 0.00 	 0.050000

 	 0.80 	 0.00 	 0.400000

 	 1.50 	 0.00 	 0.750000

 	 2.20 	 0.00 	 0.900000

 	 2.90 	 0.00 	 0.550000

 	 3.60 	 0.00 	 0.200000

 	 4.30 	 0.00 	 0.000000

 	 5.00 	 0.00 	 0.000000


 Lax-Wenroff Method:
	 x 	 t 	 u 

  	 -2.00 	 0.00 	 0.000000

 	 -1.30 	 0.00 	 0.000000

 	 -0.60 	 0.00 	 -0.006250

 	 0.10 	 0.00 	 -0.012500

 	 0.80 	 0.00 	 0.225000

 	 1.50 	 0.00 	 0.600000

 	 2.20 	 0.00 	 0.887500

 	 2.90 	 0.00 	 0.725000

 	 3.60 	 0.00 	 0.356250

 	 4.30 	 0.00 	 0.075000

 	 5.00 	 0.00 	 0.075000


	 x 	 t 	 u 

  	 -2.00 	 0.35 	 0.000781

 	 -1.30 	 0.35 	 0.000781

 	 -0.60 	 0.35 	 -0.003125

 	 0.10 	 0.35 	 -0.039844

 	 0.80 	 0.35 	 0.089062

 	 1.50 	 0.35 	 0.423437

 	 2.20 	 0.35 	 0.800000

 	 2.90 	 0.35 	 0.832031

 	 3.60 	 0.35 	 0.529688

 	 4.30 	 0.35 	 0.180469

 	 5.00 	 0.35 	 0.180469


	 x 	 t 	 u 

  	 -2.00 	 0.70 	 0.001270

 	 -1.30 	 0.70 	 0.001270

 	 -0.60 	 0.70 	 0.002930

 	 0.10 	 0.70 	 -0.042188

 	 0.80 	 0.70 	 -0.001074

 	 1.50 	 0.70 	 0.250977

 	 2.20 	 0.70 	 0.654785

 	 2.90 	 0.70 	 0.857813

 	 3.60 	 0.70 	 0.686719

 	 4.30 	 0.70 	 0.311426

 	 5.00 	 0.70 	 0.311426


	 x 	 t 	 u 

  	 -2.00 	 1.05 	 0.001062

 	 -1.30 	 1.05 	 0.001062

 	 -0.60 	 1.05 	 0.007947

 	 0.10 	 1.05 	 -0.030408

 	 0.80 	 1.05 	 -0.047998

 	 1.50 	 1.05 	 0.105981

 	 2.20 	 1.05 	 0.477979

 	 2.90 	 1.05 	 0.803064

 	 3.60 	 1.05 	 0.797791

 	 4.30 	 1.05 	 0.452161

 	 5.00 	 1.05 	 0.452161


	 x 	 t 	 u 

  	 -2.00 	 1.40 	 0.000201

 	 -1.30 	 1.40 	 0.000201

 	 -0.60 	 1.40 	 0.010159

 	 0.10 	 1.40 	 -0.013826

 	 0.80 	 1.40 	 -0.060649

 	 1.50 	 1.40 	 0.001740

 	 2.20 	 1.40 	 0.297844

 	 2.90 	 1.40 	 0.681816

 	 3.60 	 1.40 	 0.842972

 	 4.30 	 1.40 	 0.581772

 	 5.00 	 1.40 	 0.581772


	 x 	 t 	 u 

  	 -2.00 	 1.75 	 -0.001043

 	 -1.30 	 1.75 	 -0.001043

 	 -0.60 	 1.75 	 0.009423

 	 0.10 	 1.75 	 0.001021

 	 0.80 	 1.75 	 -0.050889

 	 1.50 	 1.75 	 -0.058669

 	 2.20 	 1.75 	 0.138808

 	 2.90 	 1.75 	 0.517682

 	 3.60 	 1.75 	 0.815188

 	 4.30 	 1.75 	 0.679722

 	 5.00 	 1.75 	 0.679722


 Leap Frog method :

 	 x 	 t 	 u 

  	 -2.00 	 0.35 	 0.000000

 	 -1.30 	 0.35 	 0.000000

 	 -0.60 	 0.35 	 -0.031250

 	 0.10 	 0.35 	 -0.212500

 	 0.80 	 0.35 	 -0.125000

 	 1.50 	 0.35 	 0.350000

 	 2.20 	 0.35 	 0.987500

 	 2.90 	 0.35 	 1.075000

 	 3.60 	 0.35 	 0.631250

 	 4.30 	 0.35 	 0.175000

 	 5.00 	 0.35 	 0.175000


	 x 	 t 	 u 

  	 -2.00 	 0.70 	 0.015625

 	 -1.30 	 0.70 	 0.015625

 	 -0.60 	 0.70 	 0.106250

 	 0.10 	 0.70 	 0.096875

 	 0.80 	 0.70 	 0.118750

 	 1.50 	 0.70 	 0.193750

 	 2.20 	 0.70 	 0.537500

 	 2.90 	 0.70 	 0.728125

 	 3.60 	 0.70 	 0.650000

 	 4.30 	 0.70 	 0.228125

 	 5.00 	 0.70 	 0.228125


	 x 	 t 	 u 

  	 -2.00 	 1.05 	 -0.045313

 	 -1.30 	 1.05 	 -0.045313

 	 -0.60 	 1.05 	 -0.071875

 	 0.10 	 1.05 	 -0.218750

 	 0.80 	 1.05 	 -0.173438

 	 1.50 	 1.05 	 0.140625

 	 2.20 	 1.05 	 0.720312

 	 2.90 	 1.05 	 1.018750

 	 3.60 	 1.05 	 0.881250

 	 4.30 	 1.05 	 0.385938

 	 5.00 	 1.05 	 0.385938


	 x 	 t 	 u 

  	 -2.00 	 1.40 	 0.028906

 	 -1.30 	 1.40 	 0.028906

 	 -0.60 	 1.40 	 0.192969

 	 0.10 	 1.40 	 0.147656

 	 0.80 	 1.40 	 -0.060937

 	 1.50 	 1.40 	 -0.253125

 	 2.20 	 1.40 	 0.098437

 	 2.90 	 1.40 	 0.647656

 	 3.60 	 1.40 	 0.966406

 	 4.30 	 1.40 	 0.475781

 	 5.00 	 1.40 	 0.475781


	 x 	 t 	 u 

  	 -2.00 	 1.75 	 -0.127344

 	 -1.30 	 1.75 	 -0.127344

 	 -0.60 	 1.75 	 -0.131250

 	 0.10 	 1.75 	 -0.091797

 	 0.80 	 1.75 	 0.026953

 	 1.50 	 1.75 	 0.060937

 	 2.20 	 1.75 	 0.269922

 	 2.90 	 1.75 	 0.584766

 	 3.60 	 1.75 	 0.967188

 	 4.30 	 1.75 	 0.631250

 	 5.00 	 1.75 	 0.631250         
 	 
 ( All result are correct upo 6 decimal places  )                      
